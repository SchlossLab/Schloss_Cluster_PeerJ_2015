full_otus <- c("A,B,C,D,E", "F,G,H", "I,J,K,L", "M,N", "O,P", "Q", "R", "S", "T")full_map <- c(A=1,B=1,C=1,D=1,E=1,				F=2,G=2,H=2,				I=3,J=3,K=3,L=3,				M=4,N=4,				O=5,P=5,				Q=6, R=7, S=8, T=9)partial1_otus <- c("A,B,C,D,E", "F,G,H", "I,J,L", "M", "O,P", "Q", "R", "T")partial1_map <- c(A=1,B=1,C=1,D=1,E=1,				F=2,G=2,H=2,				I=3,J=3,L=3,				M=4,				O=5,P=5,				Q=6, R=7, T=8)prune1_map <- c(A=1,B=1,C=1,D=1,E=1,				F=2,G=2,H=2,				I=3,J=3,L=3,				M=4,				O=5,P=5,				Q=6, R=7, T=9)partial2_otus <- c("B,C,D,E", "F,G,H", "I,J,L", "O,P", "Q", "R", "T")partial2_map <- c(B=1,C=1,D=1,E=1,				F=2,G=2,H=2,				I=3,J=3,L=3,				O=4,P=4,				Q=5, R=6, T=7)test_full_names <- c("A", "F", "H", "I", "K", "M", "O", "Q", "R", "S", "T")test_partial_names <- c("A", "F", "H", "I", "K", "O", "Q", "S", "T")test_that("testing get_list_data", {	expect_equal(get_list_data("test_character.list"), full_otus)	expect_equal(get_list_data("test_number.list"), full_otus)})test_that("testing map_reads", {	expect_equal(map_reads(partial2_otus[2], 2), c(F=2,G=2,H=2))	expect_equal(map_reads(partial2_otus[3], 3), c(I=3,J=3,L=3))	expect_equal(map_reads(partial2_otus[7], 7), c(T=7))})test_that("testing get_map",{	expect_equal(get_map(full_otus), full_map)	expect_equal(get_map(partial1_otus), partial1_map)	expect_equal(get_map(partial2_otus), partial2_map)})test_that("testig get_names", {	expect_equal(get_names("test_full.names"), test_full_names)	expect_equal(get_names("test_partial.names"), test_partial_names)})test_that("testing prune_map", {	expect_equal(prune_map(full_map, c("A","B","C","D","E","F","G","H","I","J","L","M","O","P","Q","R","T")), prune1_map)	expect_equal(prune_map(full_map, c("A","B","C","D","E","F","G","H","I","J","L","M","O","P","Q","R","T", "Z")), prune1_map)})test_that("testing cpp_confusion_matrix", {	expect_equal(cpp_confusion_matrix(c(A=1,B=1,D=1), c(A=1,B=1,D=2)), c(tp=1,tn=0,fp=2,fn=0))	expect_equal(cpp_confusion_matrix(c(A=1,B=2,D=1), c(A=1,B=2,D=1)), c(tp=1,tn=2,fp=0,fn=0))	expect_equal(cpp_confusion_matrix(c(A=1,B=2,D=1), c(A=1,B=2,D=3)), c(tp=0,tn=2,fp=1,fn=0))	expect_equal(cpp_confusion_matrix(c(A=1,B=2,D=3), c(A=1,B=2,D=1)), c(tp=0,tn=2,fp=0,fn=1))})test_that("testing mcc", {	expect_equal(mcc(c(tp=10,tn=10,fp=0,fn=0)), 1.0)	expect_equal(mcc(c(tp=0,tn=0,fp=10,fn=10)), -1.0)	expect_equal(mcc(c(tp=0,tn=2,fp=1,fn=0)), NA)	expect_equal(mcc(c(tp=10,tn=2,fp=2,fn=10)), 0)	expect_equal(mcc(c(tp=100,tn=20,fp=20,fn=50)), 0.141, tolerance=0.001)	expect_equal(mcc(c(tp=80,tn=50,fp=10,fn=10)), 0.722, tolerance=0.001)	expect_equal(mcc(c(tp=80,tn=80,fp=80,fn=80)), 0.000, tolerance=0.001)})test_that("system testing", {	test <- c("A"=1, "F"=2, "H"=2, "I"=3, "O"=5, "Q"=6, "T"=9)	ref <- c("A"=1, "F"=2, "H"=2, "I"=3, "O"=5, "Q"=6, "T"=9, "Z"=1)	expect_equal(get_confusion_matrix(test, ref), get_confusion_matrix(ref, test))	test <- c("A"=1, "F"=2, "H"=2, "I"=3, "O"=5, "Q"=6, "T"=9)	ref <- c("A"=1, "F"=2, "H"=2, "I"=3, "Q"=6, "T"=9, "Z"=1)	expect_equal(get_confusion_matrix(test, ref), get_confusion_matrix(ref, test))	test <- c("A"=1, "F"=2, "H"=2, "I"=3, "O"=5, "Q"=6, "T"=9)	ref <- c("A"=1, "F"=2, "H"=2, "I"=4, "O"=5, "Q"=6, "T"=7)	expect_equal(get_confusion_matrix(test, ref), get_confusion_matrix(ref, test))})